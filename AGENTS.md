# Repository Guidelines

## Project Structure & Module Organization
This repository is a multi-module Go project:
- Root module (`go.mod`): core breaker implementation in `breaker.go`, `googlebreaker.go`, and internal helpers under `internal/` (`internal/rollingwindow`).
- CLI module (`cmd/breaker-cli/`): code generator for interface-based breaker wrappers, with a single template source at `cmd/breaker-cli/breaker.gohtml` (embedded via `cmd/breaker-cli/template_embed.go`).
- Example module (`example/`): runnable usage samples, with entrypoint at `example/cmd/main.go`.
- CI and lint config: `.github/workflows/go.yml`, `.golangci.yaml`.

Keep tests close to implementation (for example, `googlebreaker_test.go`, `internal/rollingwindow/rollingwindow_test.go`).

## Build, Test, and Development Commands
Run from repository root unless noted:
- `go build -v ./...`: build root module packages.
- `go test -v ./...`: run unit tests.
- `go test -bench=. -benchmem`: run benchmarks for performance checks.
- `golangci-lint run`: run configured linters (`gofumpt`, `goimports`, `revive`, `staticcheck`, etc.).
- `(cd cmd/breaker-cli && go build ./...)`: build CLI module.
- `(cd cmd/breaker-cli && go run . -h)`: inspect CLI flags.
- `(cd example && go run ./cmd)`: run example program.

## Coding Style & Naming Conventions
- Follow standard Go formatting; use `gofumpt` and `goimports` before submitting.
- Use lowercase package names and descriptive file names.
- Exported symbols use `PascalCase`; unexported symbols use `camelCase`.
- Keep option-style APIs consistent with existing patterns (`WithK`, `WithWindow`).
- For generated files, preserve the header `Code generated by breaker-cli. DO NOT EDIT.`

## Testing Guidelines
- Use Goâ€™s built-in `testing` package with table-driven tests where practical.
- Test files must end with `_test.go`.
- Prefer names like `TestType_Method` and `BenchmarkType_Method`.
- Validate changes with `go test -v ./...`; use `go test -cover ./...` for coverage checks on non-trivial changes.

## Commit & Pull Request Guidelines
- Match existing history: short, imperative English commit subjects (for example, `Optimize breaker template`).
- Keep each commit focused on one logical change.
- PRs should include:
- what changed and why,
- impacted modules (`root`, `cmd/breaker-cli`, `example`),
- test/lint commands run and results,
- linked issue (if applicable).
