// Code generated by "gen"; DO NOT EDIT.

package {{.Name}}

{{range .Structs}}{{$StructName := .Name}}{{$InterfaceName := .Interface.Name}}
type {{$StructName}} struct {
	source  {{$InterfaceName}}
	breaker breaker.Breaker
}

func New{{$StructName}}(source {{$InterfaceName}}) *{{$StructName}} {
	return &{{$StructName}}{
		source:  source,
		breaker: breaker.NewGoogleBreaker(),
	}
}

{{range .Interface.Methods}}
func (b *{{$StructName}}) {{.Name}}({{range $i, $p := .Params}}{{if $i}}, {{end}}{{.Name}} {{.Type}}{{end}}) ({{range $i, $r := .Results}}{{if $i}}, {{end}}{{.Type}}{{end}}) {
	var (
		{{range .Results}}{{.Name}} {{.Type}}
		{{end}}
	)
	err = b.breaker.Do(func() error {
		{{range $i, $r := .Results}}{{if $i}}, {{end}}{{.Name}}{{end}} = b.source.{{.Name}}({{range $i, $p := .Params}}{{if $i}}, {{end}}{{.Name}}{{end}})
		return err
	})
	return {{range $i, $r := .Results}}{{if $i}}, {{end}}{{.Name}}{{end}}
}
{{end}}
{{end}}